---
import '../styles/component-styles/postgrid.css';
import PostPreview from './PostPreview.astro';
import { getCollection } from 'astro:content';
const allPosts = await getCollection('posts', ({ data }) => {
  return import.meta.env.PROD ? data.draft !== true : true;
});
allPosts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
const latestPosts = allPosts.slice(0, 3);
const gridTitle = 'Latest Posts';
---

<h1>{gridTitle}</h1>
<section class="latest">
  {
    latestPosts.map(post => (
      <PostPreview url={'/posts/' + post.slug} data={post.data} id={post.id} />
    ))
  }
</section>
